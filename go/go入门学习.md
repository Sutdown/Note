## go入门学习

> 常见问题：
>
> - **go中select+channel（goroutine）的实现机制**
>
> - 垃圾回收原理
>
> - 内存模型
>
> - goroutine调度机制，调度流程
>
> - 侵入式和非侵入式
>
> - ###### defer+recover+panic，以及相应底层原理
>
> - 方法的特别之处
>
> - 接口的作用和底层原理
>
> - slice，map原理，为什么它们都是非线形安全的
>
> - 反射高级编程

### 1 设计理念

#### go是一门面向对象的语言吗

以下为官方回答：

是的，也不是。原因是：
Go 有类型和方法，并且允许面向对象的编程风格，但没有类型层次。
Go 中的 “接口 “概念提供了一种不同的方法，我们认为这种方法易于使用，而且在某些方面更加通用。还有一些方法可以将类型嵌入到其他类型中，以提供类似的东西，但不等同于子类。
Go 中的方法比 C++ 或 Java 中的方法更通用：它们可以为任何类型的数据定义，甚至是内置类型，如普通的、“未装箱的 “整数。它们并不局限于结构（类）。
Go 由于缺乏类型层次，Go 中的 “对象 “比 C++ 或 Java 等语言更轻巧。

#### go的设计理念

go是一种基于连接（结构）与组合的语言。

go的设计理念在于工程化，更好直接的提升项目的效率。因此在并发上的封装尤其的多（比如goroutine)，同时为了语法的简明，去形成了一套完整的垃圾回收，内存模型，异常与错误（defer+panic+recover）等机制。不同于c++面向对象编程，封装继承多态三大特性的语言性质，go使用组合方法接口达成一套新的机制。

**优点：**

1. 一种支持**垃圾回收**、静态编译的系统级编程语言
2. Go对**并发(concurrency)和并行(parallelism)**的原生支持有助于利用当时正在成为主流的多核机器的优势
3. Go没有提供类(class)，但允许将方法(method)绑定到任何类型上，包括结构体、数组、切片、map，甚至是基本类型，如整型。它没有类型层次体系；我们认为继承性往往会使程序在演化过程中更难适应。相反，**Go鼓励类型的组合**。
4. Go通过其接口类型提供面向对象的多态性。任何Go类型如果拥有与某个接口相同名称和签名的方法集合，就被认为是实现了该接口，而无需额外的显式声明。



### 2 复合数据类型（数组，slice，map）



### 3 方法



### 4 接口



### 5 协程



### 6 并发



### 7 内存分配 



### 8 垃圾回收

#### 垃圾回收的五种经典算法

##### 标记-清扫

比如经典的三色标记算法。主要缺点在于可能产生内存碎片或者空洞导致新对象分配失败。

##### 标记-压缩

减少内存碎片，增加复杂度。

##### 半空间复制

空间换时间

##### 引用计数

无法解决并发，只能原子操作

##### 分代GC



#### Go语言采用并发三色标记算法进行垃圾回收

为什么不选择压缩GC  ——  TCmalloc内存分配

为什么不选择分代GC  ——  内存逃逸



##### Go垃圾回收演化

Go1.0 单协程垃圾回收

Go1.1 多协程垃圾回收

Go1.5 用户协程和后台的垃圾回收同时进行

Go1.6 大幅减少STW期间的任务

Go1.8 采用混合写屏障技术消除栈重新扫描的时间



##### 垃圾回收的阶段

```txt
触发垃圾回收 ---> 标记准备阶段 ---> 并行标记阶段 ---> 标记终止阶段 ---> 垃圾清扫阶段
     |                                                             |
     ---------------------------------------------------------------
```





### 9 反射



### 参考书籍

1. 《go底层原理剖析》（内容讲解比较通俗）
2. [go语言圣经](https://golang-china.github.io/gopl-zh/index.html)（经典书籍，存在一定难度）
3. [go语言之旅](https://tour.go-zh.org/welcome/1)（有代码讲解，最为简单，适合初步学习）
4. [语言环境 | Go 语言设计哲学](https://golang3.eddycjy.com/posts/go-env/)（可浏览，很有意思）
