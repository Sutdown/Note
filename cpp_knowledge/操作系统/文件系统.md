# OS：文件系统



[TOC]



## 考纲（参考王道2021）：

1.文件系统基础

- 文件概念；文件逻辑结构；顺序文件；索引文件；索引顺序文件；
- 目录结构：文件控制块和索引节点，单级目录结构和两级目录结构，树形目录结构，图形目录结构
- 文件共享；文件保护；访问类型；访问控制；

2.文件系统实现

- 文件系统层次结构；目录实现；文件实现；

3.磁盘组织和管理

- 磁盘的结构；磁盘调度算法；磁盘管理；



## 基础知识点:

- **文件系统服务器**管理两个部分：

  在应用层上：安全保护；文件访问控制；文件结构定义（针对数据文件）

  在物理层上：磁盘设备防护，磁盘数据存取，磁盘空间分配（针对磁盘空间）

- **文件系统的逻辑结构**：有结构文件（纪录式文件）和无结构文件（流式文件）。

  **字符流式的无结构文件实质上是记录长度为1个字符的连续结构文件**；

  记录式文件则是将文件中的记录按照不同方式排列，构成不同的逻辑结构。

  对于优缺点的讨论一般从**词或块的查找**，**文件管理**，**适用范围**三方面讨论。

- **文件的定义**：文件是以计算机硬盘为载体的存储在计算机上的信息集合。

  文件 = 文件体（文件的信息，逻辑结构） + 文件说明（文件控制块FCB，目录结构）

- **文件目录**：**文件控制块的有序集合**，用于文件描述和文件控制，实现按名存取和文件信息共享保护。

  **目录文件：**为了实现对文件目录的管理，通常文件目录以文件的形式保存在**外存**，这个文件叫做目录文件。

- 文件基本操作：

  create：找到空间，创建条目

  write：系统调用查找文件位置，再使用写指针指向；read：系统调用查找位置，再使用读指针指向。

  由于文件通常只能读或者写，因此公用同一指针。

  reposition within file，delete，truncate，open，close（其余具体见王道考研）(该文章后面会具体讲解)

- **打开文件表**：包含所有的打开信息。

- **文件打开计数器**：记录多少进程打开了文件。



## 文件系统的层次结构

（对于本节知识点的一个串联，具体细节见后）

从内存向外存

**用户接口**：文件系统需要向上层的用户提供一些简单易用的功能接口。这层用于处理一些简单易用的功能接口。（创建，删除，读，写，重定义，截断，打开，关闭）。

**文件目录系统**：用户通过文件路径访问文件，因此需要根据用户给出的路径找到相应的FCB或者索引结点。所有和目录，目录项相关的管理工作在本层完成，如管理活跃的文件目录表，管理打开文件表等。

**存取控制模块**：为了保证文件数据的安全，还需要验证用户是否有访问权限。这一层主要完成了文件保护相关功能。

**逻辑文件系统和文件信息缓冲区**：用户指明想要访问文件记录号，这一层需要将记录好转译为对应的逻辑地址。

**物理文件系统**：这一层将上一层提供的逻辑地址转化为实际的物理地址。

**辅助分配模块**：负责文件存储空间的管理，即负责分配和回收存储空间。

**设备管理模块**：直接与硬件交互，负责和硬件直接相关的一些管理工作。如：分配设备，分配设备缓冲区，磁盘调度，启动设备，释放设备等。



### 文件的基本操作（调用接口）

39章                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         



### 文件逻辑结构和目录结构                                                                                                          



   

### 文件系统的实现

40章



### 文件共享和文件保护



### 磁盘驱动器



### 廉价冗余磁盘阵列





# 附：参考资料：

1.2021王道考研操作系统

2.TJU OS邱铁老师课堂PPT

3.《Operating Systems：Three Easy Pieces》



