**Multi-authority Attribute Based Encryption**

——Melissa Chase

[多权威属性基加密—知乎](https://zhuanlan.zhihu.com/p/386569505)

简评：很好的论文，对于算法的实现逐层递进，讲述了每个随机数或者其它字母设置的原因和影响。

### 介绍



##### 过去的方案

Sahai和Waters提出单一权威属性加密方案（single authority attribute encryption，简称SW）。发送方指定一个属性集和一个数字d对消息进行加密，这样当至少拥有d个给定属性的接收方才能解密该消息。

限制在于：用户需要向某个受信任的服务器表明身份，证明它有特定属性，获得解密密钥。该服务器知道所有的属性，主系统密钥，安全性并不可靠。



##### 现在的方案

本文提出一种基于多权威属性的加密方案。让发送者为每个权限K指定一组由该权限监控的属性和某个阈值D，以便消息由每个权限中给定数量属性的用户解密。

（密钥的分发由多个权威机构（也就是服务器）共同分发，每个服务器对应相应的权限，至少有K个权限中的）

（类似于生活中，每个属性都不是只完全由一个机构审查，比如学生身份由大学证明，工作身份由单位证明…大概这个原理，因此ABE的一个受信任方难以用于实践）



##### 可能存在的问题

1. 防共谋。不同属性的用户合谋，可能达成属性加密中的阈值破坏安全。（SW中通过不同用户生成私钥时的随机值保证用户之间密钥不能组合）
2. 多权威机构的存在，允许部分权威机构被破坏，使得只要有部分权威机构可信，那也能保障安全性。
   - 权威机构可以内部引入SW技术防共谋
   - （同时需要权威1和权威2的属性时，涉及权威机构外部问题）权威机构外部不能采用SW，SW通过查看属性进行随机化密钥，然后我们希望当局中没有沟通。具体措施见GID。



##### 解决的方法

1. GID全局标识符，每个用户有自己唯一的GID

   - 任何用户都不能声明另一个用户的标识符
   - 所有权限都可以验证用户的标识符

   GID需要区分这些情况防共谋，不同用户对属性集向同一个权威的请求，同一用户不同属性集向不同权威的请求。

   

2. CA中央权威（秘密共享）

   为了确保用户的解密能力取决于属性。

   每个权威机构有一个伪随机函数（PRF），用于随机化密钥。、

   

   用户请求密钥时，不同的权威机构根据用户的GID上计算PRF，（同一个GID：不同秘密能结合，PRF：防止不同用户共谋）然后将结果用作SW密钥生成中的秘密，最后对于有足够属性的用户，CA能够知道所有机构的PRF生成的秘密，进行结合生成独立的解密值。既保证了用户信息安全，也达到了防共谋。

   其中可以将结果组合获得固定值，得到独立于GID的密文。（这也是密文的一般生成方法）
   
   （题外话：更加细粒化的在于为属性权限创造一个公式，比如CPABE的访问树或者LSSS）



### Preliminaries



我们的ABE方案中：

属性域有K个不相交的集合，每个集合由不同的权威机构监控，还有一个受信任的中央机构，不监控属性。

$A_U$用户属性集，$A_C$密文属性集，$A_U^K,A_C^K$用户和密文属性集中权限k处理的属性。

大致方案：

![51](F:\论文\Week\image\51.jpg)

注意：系统中的权限数量不需要永久固定，可以在任何时候向系统添加附加属性权限。

方案需要在选择性ID模型中被证明是安全的。

安全游戏：

![52](F:\论文\Week\image\52.jpg)

该方案只针对静态属性，只为每个GID颁发一组密钥。如果是相同GID不同属性集的请求，权威机构可以拒绝请求。并且用户有范围内的GID，需要改变属性集时同时变动GID。

Definition：

- 多权威属性方案在选择性ID中是安全的，敌手在博弈中成功的概率不高于$\frac12+v(k)$.
- BDH假设（Bilinear Diffie-Hellman Assumption)



### Single Authority ABE

将简单的ABE方案（Sahai和Waters的“Fuzzy ABE”或“Threshold ABE”）转换成多权威机构方案。

(这个思路在ABE中十分常见)

##### Step One - FeldmanVSS

![ ](F:\论文\Week\image\53.jpg)

对于用户的密钥而言，它会为自己设置一个秘密值，然后采用该密钥对message进行加密。

通过i的属性值，利用拉格朗日插值的思维找到原多项式，进而找到秘密值，进行解密。

##### Step Two - Specifying attributes

如果采用上述方法，任何有d个属性的用户都能解密，但我们希望每个加密者都能给出一个特定属性子集，使得至少有特定的d个是解密所必须的。

![54](F:\论文\Week\image\54.jpg)

step2中，加密器可以通过为所需集合中的每个属性i利用$g^{t_i}$指定哪些属性是相关的，通过引入$t_i$进行特定属性的标识，而且$g^{p(0)}$理论是也还是隐藏的信息。

##### Step Three - Multiple Encryptions

 在上述加密中依旧存在问题，

我们希望能够进行多次加密 不需要解密器每次都获得一个新的密钥，但是，一旦用户获得了$e(g,g)^{p(0)}$，无论他是否拥有合适的属性集，他都可以解密后序的加密。

![55](F:\论文\Week\image\55.jpg)

因此，我们为每次加密选择了一个不同的随机值s，使得每个$e(g,g)^{p(0)s}$对每个密文都是不同的。

同时也解决了另一个问题，现在解密一条消息需要知道合适的属性i和s，因此我们能够发布$T_i=g^{t_i}$和$Y=e(g,g)^{p(0)}$作为公钥，（因为有s进一步隐藏），每个加密者可以喧杂随机s计算$E_i=T_i^s,i\in A_c$和$Y^sm$。

并且，E仍然是隐藏的，即使用户知道$T_i$和Y，因此基于BDH假设，依然能证明这个方案是sid安全的。

### Multi Authorities

现在考虑多权威情形，同样按照上面单一权威的思路，逐个问题解决，逐个递进。

##### 1

At a first thought

多个SW的拷贝，each for anthority。我们希望用户只有在他有每k个anthorities中有至少d个特定的属性才能解密。现在，依照上述单一权威的思路，简单的解决方案是让每个anthority给出自己的多项式，然后使用加法秘密共享形成SW秘密。（每个authority的秘密为$y_i$，最终的为主秘密$y_0$)

Then

对于message进行加密，将各个权威的结果汇总得到message。

然而，如果用户没有足够的来自一个授权机构的所需属性，那么该授权机构的SW秘密需要保持不可区分性。

![56](F:\论文\Week\image\56.jpg)

##### 2

上述方案存在的问题在于，

假设一个加密器加密一条包含每个权威在内的属性集$A_C$，现在如果存在一组用户，每个用户各自从不同权限中获取$A_u=A_C^K$​，但并没有从其他属性权威中获得属性，如果这些用户进行合谋，每个用户k用它的属性集为权威机构寻找秘密值，最后进行组合得到主秘密值从而得到秘密值。

因此需要GID用来区分不同的用户。

**同时**，需要采取一些方法确保不同用户不能将来自不同权限的结果联合起来。

假设，我们有每个权威机构k为每个用户选择不同的随机值$y_{k,u}$，让$y_{u,0}$成为用户u的主秘密，由于用户间的秘密独立，因此也能实现防共谋（SW方案让不同的多项式对每个用户以不同的方式分割秘密）。

现在也能使用类似技术防止跨anthority之间的合谋：我们选择一组新的$y_{k,u}$值，以不同的方式为每个用户在授权机构之间划分秘密。

**并且**，我们要保证对于所有用户$\prod_{k=1}^Ke(g,g)^{y_{k,u}}=e(g,g)^{y_{y_0,u}}$该式成立。

第一思考，可能需要不同authority之间进行沟通。让authority之间共享时，一个authority能够根据另一个确保$\sum_{k=1}^Ky_{k,u}=y_0$,但是我们并不一定要求所有的authority都是完全可信的，因此我们可能不希望他们共享这些信息。

因此需要CA，不处理任何属性，但必须被信任。

CA知道足够的秘密对$y_{k,u}$进行重构，它使用这些信息提供密钥，使得它和加密中给定的$g_s$还有其他权威机构的$y_{k,u}^s$相结合时能得到主秘密$Y_0^s=e(g,g)^{y_0s}$，然后能获得m。这样只需要信任一个authority，并且它不是属性authority。

CA存储所有PRF的种子

![57](F:\论文\Week\image\57.jpg)

同样，该方案是sid安全。



安全博弈部分（暂时忽略）

### MultiAuthority + Large Universe and Complex Access Structures

Large Construction的优点在于公钥的大小仅仅依赖于加密所需的最大属性数（基本SW中公钥大小和系统中属性总数成正比），因此该方案包含更多的属性。

该构造允许authority给出比简单的n中取门限更一半的策略对应的密钥，特别的，它们允许任何可以用访问树策略。

在下面的multiauthority large universe access control structure ABE系统中，每个authority为每个用户选择一个访问结构，并且给他一个相关联的密钥。当用户属性姐满足访问结构时能够解密密文。

每个authority允许一个单一机构协议的副本，并单独运行一个公钥的副本，将每个授权机构的主密钥替换为用户ID上的一个PRF，这样整个系统的主密钥就能以不同的方式为每个用户所在的机构进行划分，最后需要一个中央授权机构确保对每个用户，所有的授权机构的PRF都能被组合获得系统秘密。

MultiAuthority Scheme for Large Universe and Complex Access Structures

![58](F:\论文\Week\image\58.jpg)

![58](F:\论文\Week\image\59.jpg)

当有足够的属性进行解密时，对于每个权威机构进行计算，并利用CA计算秘密最后解密得到密文。

### Extensions

暂时放放。



这篇论文整体是非常好的，多权威的安全证明跳了，最后大宇宙结构也没怎么仔细看，还有延申部分也先放放，看不下去了，今天身体不好不宜学习，看着下回还是什么时候状态好点把这篇论文重新看看，我感觉我跳过的那部分很值得重点看看。
