# Intuitive Advanced Cryptography

[GitHub - cryptosubtlety/intuitive-advanced-cryptography: Intuitive Advanced Cryptography](https://github.com/cryptosubtlety/intuitive-advanced-cryptography)



[TOC]

这篇论文主要以实例引入，简单算法和适当讲解的方式介绍了一些高等协议。

就挑着讲以下两部分(跟当前学的内容契合度比较高)

- ECDH密钥交换+基于配对的密码学

- 零知识证明+环签名



### 背景知识

- 群（阶，单位元，生成元，子群）

- 域（域是一个集合 *F*，集合上有加法和乘法 2 个操作，无时无刻不在和域打交道。实数集 R、有理数集 Q、复数集 C 配以常规的加法和乘法都是经典的域。）

- 椭圆曲线（基点，子群）

- 多项式模

  为什么密码学中广泛使用椭圆曲线呢？

  从**数学**角度来看，原因是椭圆曲线的点形成了群，有很好的的数学性质。但是有群结构并不足以在密码学上有用。

  从**安全**角度来看，椭圆曲线很流行是因为**离散对数问题**非常难，即给定点 𝑋*X*，基点G，很难找到 x 使得 X=xG，我们一般把这里的 𝑥*x* 写作 log⁡𝐺𝑋。

比如：

G是一个群，阶为N，也就是N个元素。

$G_{p_1}$是G的子群，阶为$p_1$

$Z_p$为有限群（$Z_p$,+)，单位元为0，任意有限群中的元素x和0左右相加都为x。

生成元为1，多个1和mod p加法可以得到$Z_p$的所有元素。



### 椭圆曲线 Die-Hellman (ECDH) 密钥交换

Alice想给Bob以安全的方式发送信息，Diffie和Hellman发明了一种协议解决这个问题。

![13](F:\论文\Week\image\13.png)

前提：椭圆曲线E，阶为q的基点G。

Alice：公钥A     Bob：公钥B     共享密钥abG



如果Eve想要偷听

- 偷听到A=aG，B=bG，由于椭圆曲线的离散对数问题难解，因此共享密钥安全

  **CDH(Computational Diffie-Hellman)假设：**给定G，aG，bG几乎无法算法abG。

- 若Eve**主动攻击**，Eve可以与Alice，Bob都建立一个共享密钥，就可以解密密文。解决方案：数字签名。



### 零知识证明

> 零知识证明是指在不透露某样东西的前提下，向别人证明你知道这样东西。

##### 交互式零知识证明

###### Schnorr ID协议

![14](F:\论文\Week\image\14.png)

1. 通过以上过程，Bob就能知到Alice知不知道正确的x。
2. 以上过程中，保障了Bob不知道x。同时随机数r mod q 让结果和随机数一样**，r完全遮盖了cx**的值。
3. **C是挑战空间，一定要是不可预测的**，否则的话在不知道x的情况下，只要R=eG-cX就可以让Bob的验证通过。
4. 其实在该过程中Alice是一定知道x的。因为如果在R生成之后，我们克隆Alice为Alice‘，然后另一个Alice收到c’，可以得到：𝑒𝐺=𝑅+𝑐𝑋,𝑒′𝐺=𝑅+𝑐′𝑋→(𝑒′−𝑒)𝐺=(𝑐′−𝑐)𝑋→(𝑒′−𝑒)/(𝑐′−𝑐)𝐺=𝑋，从而得到 𝑥=(𝑒′−𝑒)/(𝑐′−𝑐)。



###### Chaum-Pedersen 协议

![15](F:\论文\Week\image\15.png)

公钥P和Q两组分别和Bob之间的交互和Schnorr ID协议一致，最终两组得到一致的x即可。



##### Fiat-Shamir heuristics 和非交互式零知识证明

###### Schnorr 签名

![16](F:\论文\Week\image\16.png)

确定R后，C的生成通过哈希，因此C也不会是先选定，依旧保障了安全。

###### 非交互式 Chaum-Pedersen 协议

![18](F:\论文\Week\image\18.png)

C的哈希生成可以多依赖公共参数，提升协议安全性。



### 环签名

> 环签名（ring signature）[13] 就允许签名人混入 𝑛*n* 个用户之中，即，如果有 𝑛*n* 个用户，他们中只有一个人签了名，签名并不会泄漏是谁，但是验证者可以验证是其中的一人签的。

正常签名下，要通过自己的私钥签名，那一定会暴露身份，要不泄露身份，当前方案是“作弊”。

联想上面零知识证明中的挑战空间，

![17](F:\论文\Week\image\17.jpg)



### Shamir 密钥共享

为了保护秘密s，有个方案时将s分成多份，只有同时得到其中的k份才能重构，因此有以下思路实现：

![19](F:\论文\Week\image\19.jpg)



### 安全多方签名计算

如果利用Shamir去保护私钥x时，从攻击者视角看，直接在x在某系统重建时攻击那个系统即可，所以我们不能在同一个系统重建，而要进行**多系统交互**最后再同意生成x。

假设在两个系统中，采用**安全多方 Schnorr 签名计算**。

![20](F:\论文\Week\image\20.png)

(R,e)是有效的x进行的m的签名



### 基于配对的密码学

![21](F:\论文\Week\image\21.jpg)



### 盲签名

### 不经意传输

![22](F:\论文\Week\image\22.jpg)



### 承诺机制

### 格密码学